# JT808协议 - 0x0200 位置信息汇报消息

## 概述

0x0200消息是JT808协议中的位置信息汇报消息，终端定时或按需向平台汇报位置信息。该消息包含了车辆的位置、状态、报警信息等关键数据。

## 消息结构

### 消息ID

- **消息ID**: `0x0200`
- **消息类型**: 终端上行消息
- **消息名称**: 位置信息汇报

### 消息体结构

| 字段名称  | 数据类型   | 长度(字节) | 描述                        |
|-------|--------|--------|---------------------------|
| 报警标志位 | DWORD  | 4      | 报警状态标志位                   |
| 状态位   | DWORD  | 4      | 车辆状态标志位                   |
| 纬度    | DWORD  | 4      | 纬度值×10^6，精确到百万分之一度        |
| 经度    | DWORD  | 4      | 经度值×10^6，精确到百万分之一度        |
| 高程    | WORD   | 2      | 海拔高度，单位：米                 |
| 速度    | WORD   | 2      | 速度，单位：1/10 km/h           |
| 方向    | WORD   | 2      | 方向角度，0-359，正北为0，顺时针       |
| 时间    | BCD[6] | 6      | YY-MM-DD-hh-mm-ss，GMT+8时间 |
| 附加信息  | -      | 可变     | 可选的附加信息                   |

**总长度**: 28字节（固定部分）+ 附加信息长度

## 字段详细说明

### 1. 报警标志位 (4字节)

报警标志位采用位操作方式，每一位代表一种报警状态：

| 位  | 十六进制值      | 报警类型           | 描述             |
|----|------------|----------------|----------------|
| 0  | 0x00000001 | 紧急报警           | 紧急按钮触发         |
| 1  | 0x00000002 | 超速报警           | 车辆超过限定速度       |
| 2  | 0x00000004 | 疲劳驾驶           | 连续驾驶时间过长       |
| 3  | 0x00000008 | 危险预警           | 预警信息           |
| 4  | 0x00000010 | GNSS模块故障       | 定位模块异常         |
| 5  | 0x00000020 | GNSS天线未接或被剪断   | 天线连接异常         |
| 6  | 0x00000040 | GNSS天线短路       | 天线短路故障         |
| 7  | 0x00000080 | 终端主电源欠压        | 主电源电压不足        |
| 8  | 0x00000100 | 终端主电源掉电        | 主电源断电          |
| 9  | 0x00000200 | 终端LCD或显示器故障    | 显示设备异常         |
| 10 | 0x00000400 | TTS模块故障        | 语音播报模块异常       |
| 11 | 0x00000800 | 摄像头故障          | 摄像设备异常         |
| 12 | 0x00001000 | 道路运输证 IC 卡模块故障 | 道路运输证 IC 卡模块故障 |
| 13 | 0x00002000 | 超速预警           | 超速预警           |
| 14 | 0x00004000 | 疲劳驾驶预警         | 疲劳驾驶预警         |
| 18 | 0x00040000 | 当天累计驾驶超时       | 日驾驶时间超限        |
| 19 | 0x00080000 | 超时停车           | 停车时间过长         |
| 20 | 0x00100000 | 进出区域报警         | 区域进出事件         |
| 21 | 0x00200000 | 进出路线报警         | 路线进出事件         |
| 22 | 0x00400000 | 路段行驶时间不足/过长    | 路段时间异常         |
| 23 | 0x00800000 | 路线偏离报警         | 偏离预定路线         |
| 24 | 0x01000000 | 车辆VSS故障        | 车速传感器故障        |
| 25 | 0x02000000 | 车辆油量异常         | 油量传感器异常        |
| 26 | 0x04000000 | 车辆被盗           | 防盗器触发          |
| 27 | 0x08000000 | 车辆非法点火         | 非法启动           |
| 28 | 0x10000000 | 车辆非法位移         | 非法移动           |
| 29 | 0x20000000 | 碰撞预警           | 碰撞检测           |
| 30 | 0x40000000 | 侧翻预警           | 侧翻检测           |
| 31 | 0x80000000 | 非法开门报警         | 未设防时开门         |

### 2. 状态位 (4字节)

状态位用于表示车辆和终端的各种状态信息，采用32位二进制表示。

#### 状态位定义表

| 位     | 定义          | 说明                                   |
|-------|-------------|--------------------------------------|
| 0     | ACC开关状态     | 0：ACC关；1：ACC开                        |
| 1     | 定位状态        | 0：未定位；1：定位                           |
| 2     | 南北纬         | 0：北纬；1：南纬                            |
| 3     | 东西经         | 0：东经；1：西经                            |
| 4     | 运营状态        | 0：运营状态；1：停运状态                        |
| 5     | 经纬度加密状态     | 0：未加密；1：已加密                          |
| 6-7   | 保留          | 保留位                                  |
| 8-9   | 载重状态        | 00：空车；01：半载；10：保留；11：满载              |
| 10    | 车辆油路状态      | 0：正常；1：断开                            |
| 11    | 车辆电路状态      | 0：正常；1：断开                            |
| 12    | 车门锁定状态      | 0：解锁；1：加锁                            |
| 13    | 门1状态        | 0：门1关；1：门1开（前门）                      |
| 14    | 门2状态        | 0：门2关；1：门2开（中门）                      |
| 15    | 门3状态        | 0：门3关；1：门3开（后门）                      |
| 16    | 门4状态        | 0：门4关；1：门4开（驾驶席门）                    |
| 17    | 门5状态        | 0：门5关；1：门5开（自定义）                     |
| 18    | GPS定位状态     | 0：未使用GPS卫星进行定位；1：使用GPS卫星进行定位         |
| 19    | 北斗定位状态      | 0：未使用北斗卫星进行定位；1：使用北斗卫星进行定位           |
| 20    | GLONASS定位状态 | 0：未使用GLONASS卫星进行定位；1：使用GLONASS卫星进行定位 |
| 21    | Galileo定位状态 | 0：未使用Galileo卫星进行定位；1：使用Galileo卫星进行定位 |
| 22-31 | 保留          | 保留位，由厂商自定义                           |

### 3. 位置信息

#### 纬度/经度 (各4字节)

- **格式**: 以度为单位的坐标值乘以10^6
- **精度**: 百万分之一度
- **示例**: 纬度39.123456°存储为39123456

#### 高程 (2字节)

- **单位**: 米
- **范围**: 0-65535米

#### 速度 (2字节)

- **单位**: 1/10 km/h
- **示例**: 速度60.5 km/h存储为605

#### 方向 (2字节)

- **单位**: 度
- **范围**: 0-359
- **基准**: 正北为0度，顺时针方向

### 4. 时间 (6字节BCD码)

时间采用BCD码格式存储：

- **格式**: YY-MM-DD-hh-mm-ss
- **时区**: GMT+8（北京时间）
- **编码**: 每个字节的高4位和低4位分别表示一位十进制数

**示例**:

- 时间: 2023年12月25日 14:30:45
- BCD编码: 0x23 0x12 0x25 0x14 0x30 0x45

### 5. 附加信息 (可变长度)

附加信息为可选字段，可包含额外的车辆状态或传感器数据。
位置附加信息项列表由各位置附加信息项组合，也可没有，根据消息头中的长度字段确
定。

#### 5.1 附加信息项结构

附加信息项是可选的，用于传输额外的车辆状态和位置信息。每个附加信息项包含：

- 附加信息ID（1字节，范围1-255）
- 附加信息长度（1字节）
- 附加信息内容（变长，具体定义见下表）

#### 5.2 附加信息项定义表

| 附加信息ID    | 长度  | 描述及要求                        |
|-----------|-----|------------------------------|
| 0x01      | 4   | 里程，DWORD，1/10km，对应车上里程表读数    |
| 0x02      | 2   | 油量，WORD，1/10L，对应车上油量表读数      |
| 0x03      | 2   | 行驶记录功能获取的速度，WORD，1/10km/h    |
| 0x04      | 2   | 需要人工确认报警事件的ID，WORD，从1开始计数    |
| 0x05-0x10 | -   | 保留                           |
| 0x11      | 1或5 | 超速报警附加信息，详见表28               |
| 0x12      | 6   | 进出区域/路线报警附加信息，详见表29          |
| 0x13      | 7   | 路段行驶时间不足/过长报警附加信息，详见表30      |
| 0x14-0x24 | -   | 保留                           |
| 0x25      | 4   | 扩展车辆信号状态位，详见表31              |
| 0x2A      | 2   | IO状态位，详见表32                  |
| 0x2B      | 4   | 模拟量，bit0-15为AD0；bit16-31为AD1 |
| 0x30      | 1   | 无线通信网络信号强度，BYTE              |
| 0x31      | 1   | GNSS定位卫星数，BYTE               |
| 0xE0      | 变长  | 后续自定义信息长度                    |
| 0xE1-0xFF | 变长  | 自定义区域                        |

#### 5.3 超速报警附加信息（表28）

| 起始字节 | 字段      | 数据类型  | 描述及要求                              |
|------|---------|-------|------------------------------------|
| 0    | 位置类型    | BYTE  | 0：无特定位置；1：圆形区域；2：矩形区域；3：多边形区域；4：路段 |
| 1    | 区域或路段ID | DWORD | 若位置类型为0，无该字段                       |

#### 5.4 进出区域/路线报警附加信息（表29）

| 起始字节 | 字段      | 数据类型  | 描述及要求                      |
|------|---------|-------|----------------------------|
| 0    | 位置类型    | BYTE  | 1：圆型区域；2：矩形区域；3：多边形区域；4：路线 |
| 1    | 区域或线路ID | DWORD | -                          |
| 5    | 方向      | BYTE  | 0：进；1：出                    |

#### 5.5 路线行驶时间不足/过长报警附加信息（表30）

| 起始字节 | 字段     | 数据类型  | 描述及要求     |
|------|--------|-------|-----------|
| 0    | 路段ID   | DWORD | -         |
| 4    | 路段行驶时间 | WORD  | 单位为秒（s）   |
| 6    | 结果     | BYTE  | 0：不足；1：过长 |

#### 5.6 扩展车辆信号状态位（表31）

| 位     | 定义       |
|-------|----------|
| 0     | 1：近光灯信号  |
| 1     | 1：远光灯信号  |
| 2     | 1：右转向灯信号 |
| 3     | 1：左转向灯信号 |
| 4     | 1：制动信号   |
| 5     | 1：倒档信号   |
| 6     | 1：雾灯信号   |
| 7     | 1：示廓灯    |
| 8     | 1：喇叭信号   |
| 9     | 1：空调状态   |
| 10    | 1：空挡信号   |
| 11    | 1：缓速器工作  |
| 12    | 1：ABS工作  |
| 13    | 1：加热器工作  |
| 14    | 1：离合器状态  |
| 15-31 | 保留       |

#### 5.7 IO状态位（表32）

| 位    | 定义       |
|------|----------|
| 0    | 1：深度休眠状态 |
| 1    | 1：休眠状态   |
| 2-15 | 保留       |



## 消息示例

### 示例数据

假设一个位置汇报消息的数据如下：

```
报警标志位: 0x00000002 (超速报警)
状态位: 0x00000000
纬度: 39123456 (39.123456°)
经度: 116654321 (116.654321°)
高程: 50米
速度: 805 (80.5 km/h)
方向: 45° (东北方向)
时间: 2023-12-25 14:30:45
```

### 十六进制表示

```
00 00 00 02    // 报警标志位 (超速报警)
00 00 00 00    // 状态位
02 55 0E 40    // 纬度 (39123456)
06 F4 A9 B1    // 经度 (116654321)
00 32          // 高程 (50米)
03 25          // 速度 (805 = 80.5km/h)
00 2D          // 方向 (45度)
23 12 25 14 30 45  // 时间 (2023-12-25 14:30:45)
```

## 使用场景

1. **定时汇报**: 终端按设定间隔主动上报位置信息
2. **事件触发**: 发生报警事件时立即上报
3. **平台查询**: 响应平台的位置查询请求
4. **轨迹记录**: 用于车辆轨迹回放和分析

## 注意事项

1. **时间同步**: 确保终端时间与服务器时间同步
2. **坐标系统**: 使用WGS84坐标系统
3. **精度要求**: 位置精度应满足应用需求
4. **报警处理**: 及时处理报警信息，确保安全
5. **数据完整性**: 验证消息数据的完整性和有效性

## 相关消息

- **0x8001**: 平台通用应答
- **0x8103**: 设置终端参数
- **0x8201**: 位置信息查询
- **0x8202**: 临时位置跟踪控制

## 实现参考

本文档基于JT808协议标准和实际项目实现经验编写，具体实现可参考项目中的`T0200LocationReport.java`类。